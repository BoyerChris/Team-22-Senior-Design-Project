$PasswordPolicy = net accounts

$MinPassAge = ($PasswordPolicy | Select-String "Minimum password age \(days\):\s+(\d+)") | ForEach-Object { $_.Matches.Groups[1].Value }
$MaxPassAge = ($PasswordPolicy | Select-String "Maximum password age \(days\):\s+(\d+)") | ForEach-Object { $_.Matches.Groups[1].Value }
$MinPassLength = ($PasswordPolicy | Select-String "Minimum password length:\s+(\d+)") | ForEach-Object { $_.Matches.Groups[1].Value }
$LockoutThreshold = ($PasswordPolicy | Select-String "Lockout threshold:\s+(\S+)") | ForEach-Object { $_.Matches.Groups[1].Value }

Write-Host "Checking Password Policy"
Write-Host "-------------------------"
Write-Host "Min Password Length: $MinPassLength"
Write-Host "Min Password Age: $MinPassAge"
Write-Host "Max Password Age: $MaxPassAge"
Write-Host "Lockout Threshold: $LockoutThreshold"

if ([int]$MinPassLength -lt 8) {
    Write-Host "Warning: Password policy is weak!" -ForegroundColor Yellow
} else {
    Write-Host "Password Policy Meets Basic Standards." -ForegroundColor Green
}
